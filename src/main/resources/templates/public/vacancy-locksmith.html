<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title th:text="#{page.apply.title}">Подать заявку на работу</title>
  <link rel="stylesheet" th:href="@{/css/header.css}">
  <link rel="stylesheet" th:href="@{/css/apply-form.css}">
</head>
<body>
<!-- Header -->
<div th:replace="~{layouts/header :: header}"></div>

<!-- Main Content -->
<main class="apply-page">
  <div class="container">
    <div class="form-header">
      <h1 th:text="#{apply.form.title}">Подать заявку на работу</h1>
      <p th:text="#{apply.form.subtitle}">Заполните форму ниже, и мы свяжемся с вами в ближайшее время</p>
    </div>

    <!-- Success Message -->
    <div th:if="${successMessage}" class="alert alert-success">
      <span class="alert-icon">✓</span>
      <span th:text="${successMessage}">Заявка успешно отправлена!</span>
    </div>

    <!-- Error Messages -->
    <div th:if="${errorMessage}" class="alert alert-error">
      <span class="alert-icon">✕</span>
      <span th:text="${errorMessage}">Произошла ошибка при отправке заявки</span>
    </div>

    <!-- Application Form -->
    <form th:action="@{/apply}"
          th:object="${application}"
          method="post"
          class="application-form">

      <!-- Name -->
      <div class="form-group">
        <input type="hidden" th:field="*{profession}">
        <label for="name" th:text="#{apply.field.name}">ФИО *</label>
        <input type="text"
               id="name"
               th:field="*{name}"
               required
               placeholder="Andre Smith">
        <span class="error-message" th:if="${#fields.hasErrors('name')}" th:errors="*{name}"></span>
      </div>

      <!-- Email -->
      <div class="form-group">
        <label for="email" th:text="#{apply.field.email}">Email *</label>
        <input type="email"
               id="email"
               th:field="*{email}"
               required
               placeholder="andresmith@example.com">
        <span class="error-message" th:if="${#fields.hasErrors('email')}" th:errors="*{email}"></span>
      </div>

      <!-- Phone Number -->
      <div class="form-group">
        <label for="phonenumber" th:text="#{apply.field.phone}">Телефон *</label>
        <input type="tel"
               id="phonenumber"
               th:field="*{phone_number}"
               required
               placeholder="+351123456789">
        <span class="error-message" th:if="${#fields.hasErrors('phone_number')}" th:errors="*{phone_number}"></span>
      </div>

      <!-- Country -->
      <div class="form-group">
        <label for="country" th:text="#{apply.field.country}">Страна проживания *</label>
        <select id="country" th:field="*{country}" required>
          <option value="" th:text="#{apply.field.select}">Выберите страну</option>
          <option value="Portugal" th:text="#{country.portugal}">Португалия</option>
          <option value="Ukraine" th:text="#{country.ukraine}">Украина</option>
          <option value="Russia" th:text="#{country.russia}">Россия</option>
          <option value="Poland" th:text="#{country.poland}">Польша</option>
          <option value="Spain" th:text="#{country.spain}">Испания</option>
          <option value="Germany" th:text="#{country.germany}">Германия</option>
          <option value="France" th:text="#{country.france}">Франция</option>
          <option value="Other" th:text="#{country.other}">Другая</option>
        </select>
        <span class="error-message" th:if="${#fields.hasErrors('country')}" th:errors="*{country}"></span>
      </div>

      <!-- Experience -->
      <div class="form-group">
        <label for="experience" th:text="#{apply.field.experience}">Опыт работы (лет) *</label>
        <input type="number"
               id="experience"
               th:field="*{experience}"
               required
               min="0"
               max="50"
               placeholder="5">
        <span class="error-message" th:if="${#fields.hasErrors('experience')}" th:errors="*{experience}"></span>
      </div>

      <!-- Job Responsibilities (optional) -->
      <div class="form-group">
        <label for="jobResponsibilities" th:text="#{apply.field.responsibilities}">
          О вашем опыте работы (необязательно)
        </label>
        <textarea id="jobResponsibilities"
                  th:field="*{jobResponsibilities}"
                  rows="5"></textarea>
        <span class="error-message" th:if="${#fields.hasErrors('jobResponsibilities')}" th:errors="*{jobResponsibilities}"></span>
      </div>

      <!-- Submit Button -->
      <div class="form-actions">
        <button type="submit" class="btn-submit" th:text="#{apply.button.submit}">
          Отправить заявку
        </button>
        <a th:href="@{/}" class="btn-cancel" th:text="#{apply.button.cancel}">
          Отмена
        </a>
      </div>
    </form>
  </div>
</main>

<script th:src="@{/js/header.js}"></script>
<script>
  function changeLanguage(lang) {
    const url = new URL(window.location);
    url.searchParams.set('lang', lang);
    window.location.href = url.toString();
  }
</script>
</body>
</html>